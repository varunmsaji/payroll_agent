âœ… 1ï¸âƒ£ ATTENDANCE_SYSTEM_DOCUMENTATION.md

âœ… Create a file with this exact name in your project root

# ğŸ•’ HRMS Attendance System â€“ Complete Documentation

This document explains how the Attendance System works in simple language.  
It is written so that **HR teams, managers, testers, and developers** can all understand it clearly.

---

## 1. PURPOSE OF THE SYSTEM

The Attendance System is designed to:

- Track when employees:
  - Check in
  - Start breaks
  - End breaks
  - Check out
- Automatically calculate:
  - Total working hours
  - Net working hours
  - Break time
  - Late coming
  - Early leaving
  - Overtime
- Generate a **final payroll-safe attendance record per employee per day**
- Lock records before payroll so no one can change salary data later

---

## 2. DATABASE STRUCTURE (SIMPLE EXPLANATION)

### 2.1 `attendance_events` â€“ Raw Activity Log

This table stores **every single action**:

| Column | Meaning |
|--------|---------|
| employee_id | Who performed the action |
| event_type | check_in / check_out / break_start / break_end |
| event_time | When the action happened |
| source | manual / device / biometric |
| meta | Extra details like IP, browser, GPS |

This table **never changes** and is used for audit and debugging.

---

### 2.2 `attendance` â€“ Final Payroll Attendance Table

This table stores **one row per employee per day**:

| Column | Meaning |
|--------|---------|
| check_in | First login time |
| check_out | Final logout time |
| total_hours | Time between first in and last out |
| net_hours | Actual work time excluding breaks |
| break_minutes | Total break time |
| overtime_minutes | Extra work beyond shift |
| late_minutes | How late employee arrived |
| early_exit_minutes | How early employee left |
| is_late | True if late |
| is_early_checkout | True if left early |
| is_overtime | True if worked overtime |
| is_weekend | Saturday/Sunday |
| is_holiday | Official holiday |
| is_night_shift | Night duty |
| status | present / half_day / short_hours / absent / week_off / holiday / on_leave |
| is_payroll_locked | Locked for salary |
| locked_at | Time when locked |

This is the **main payroll table**.

---

## 3. HOW ATTENDANCE IS CAPTURED

Whenever an employee performs an action:

| Action | Database Effect |
|--------|-----------------|
| Check-in | Adds row in `attendance_events` |
| Break Start | Adds row in `attendance_events` |
| Break End | Adds row in `attendance_events` |
| Check-out | Adds row in `attendance_events` |

Immediately after each action, the system:

âœ… Recalculates attendance for that day  
âœ… Updates the `attendance` table  

---

## 4. SHIFT & WORK WINDOW LOGIC

The system checks the employee shift:

- Morning shift â†’ 9:00 AM to 6:00 PM
- Night shift â†’ 9:00 PM to 6:00 AM (next day)

Attendance calculations only happen **inside the shift window**.

If no shift is assigned:
- Default work window = 12:00 AM to 11:59 PM
- Default required hours = 8 hours

---

## 5. HOW WORK HOURS ARE CALCULATED

### Example Timeline:

| Time | Action |
|------|--------|
| 09:10 | Check-in |
| 13:00 | Break start |
| 13:30 | Break end |
| 18:05 | Check-out |

### System Calculates:

- Total time = 09:10 â†’ 18:05 â‰ˆ 8.91 hours
- Break time = 30 minutes
- Net work hours = 8.41 hours

---

## 6. LATE COMING CALCULATION

- Shift start time is compared with actual check-in
- Grace time = **10 minutes**
- If employee is late beyond grace â†’ marked as **Late**

Example:
- Shift starts at 09:00  
- Employee checks in at 09:12  
â†’ Late = 12 minutes â†’ Late marked âœ…

---

## 7. EARLY EXIT CALCULATION

- Shift end time is compared with check-out time
- Grace time = **10 minutes**
- Leaving earlier than grace â†’ marked Early Checkout âœ…

---

## 8. OVERTIME CALCULATION

If:



Net Work Hours > Required Shift Hours


Then:



Overtime Minutes = Extra Minutes Worked


---

## 9. ATTENDANCE STATUS DECISION

| Condition | Status |
|----------|--------|
| Net hours â‰¥ 75% of shift | present |
| Net hours â‰¥ 50% | half_day |
| Less than 50% | short_hours |
| No events + leave approved | on_leave |
| No events + holiday | holiday |
| No events + weekend | week_off |
| No events | absent |

---

## 10. PAYROLL LOCK SYSTEM

Once HR locks attendance:

- `is_payroll_locked` becomes TRUE
- No changes allowed:
  - No recalculation
  - No override
  - No new attendance edits

This guarantees **salary safety & legal protection**.

---

## 11. MANUAL OVERRIDE SYSTEM (HR ONLY)

HR can correct:

- Wrong check-in time
- Wrong check-out time
- Net working hours
- Attendance status

âš ï¸ Overrides only work when:



is_payroll_locked == FALSE


---

## 12. REPORTING & DASHBOARDS SUPPORTED

âœ… Employee Dashboard  
âœ… Manager Team Attendance  
âœ… HR Company Attendance  
âœ… Late Coming Report  
âœ… Overtime Report  
âœ… Payroll Lock Panel  
âœ… Raw Attendance Logs  

---

## âœ… FINAL SUMMARY

This HRMS Attendance System:

âœ” Automatically records all work activity  
âœ” Calculates payroll-ready attendance  
âœ” Handles leave, holidays, weekends  
âœ” Prevents salary manipulation  
âœ” Supports audit and compliance  

---

âœ… This system is suitable for:
- Corporate HRMS
- Salary processing
- Factory staff tracking
- Office workforce attendance

âœ… 2ï¸âƒ£ TEXT FLOWCHART â€“ ATTENDANCE SYSTEM WORKING

âœ… This can be shared with designers, managers, and testers

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       EMPLOYEE ACTION        â”‚
â”‚ (Check-In / Break / CheckOut)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SAVE RAW EVENT in DATABASE  â”‚
â”‚   (attendance_events table) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SYSTEM STARTS DAILY RECALCULATION  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Is Attendance Payroll Lockedâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       YES â—„â”€â”€â”€â”˜               â””â”€â”€â”€â–º NO
   âŒ Stop Process                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Get Employee Shift  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Load Shift Time     â”‚
                          â”‚ (Day / Night Logic)â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Fetch Today's Eventsâ”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ Any Events Found Today?    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              YES        NO
                              â”‚          â”‚
                              â–¼          â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Calculate Work Time â”‚   â”‚ Is Holiday / Leave /   â”‚
               â”‚ Calculate Break Timeâ”‚   â”‚ Weekend?               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                          â”‚
                         â–¼                          â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Calculate Late      â”‚   â”‚ Set Status: Holiday /  â”‚
               â”‚ Calculate Early Exitâ”‚   â”‚ Leave / Week-off /     â”‚
               â”‚ Calculate Overtime  â”‚   â”‚ Absent                 â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                          â”‚
                         â–¼                          â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Decide Attendance Status (Present,     â”‚
               â”‚ Half-Day, Short Hours)                 â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Save Final Attendance Row into         â”‚
               â”‚         attendance table               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
               âœ… Attendance Ready for Payroll & Reports
